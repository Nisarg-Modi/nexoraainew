<!DOCTYPE html>
<html>
<head>
  <title>Authentication</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      background: #f5f5f5;
    }
    .message {
      text-align: center;
      color: #666;
    }
  </style>
</head>
<body>
  <div class="message">
    <p>Connecting to Google Calendar...</p>
  </div>
  <script>
    // Extract token from URL hash
    const hash = window.location.hash.substring(1);
    const params = new URLSearchParams(hash);
    const accessToken = params.get('access_token');
    const error = params.get('error');

    if (accessToken) {
      // Send token to opener window
      if (window.opener) {
        window.opener.postMessage({
          type: 'google-auth',
          token: accessToken
        }, window.location.origin);
      }
      window.close();
    } else if (error) {
      console.error('OAuth error:', error);
      if (window.opener) {
        window.opener.postMessage({
          type: 'google-auth-error',
          error: error
        }, window.location.origin);
      }
      window.close();
    } else {
      console.error('No access token or error found in URL');
      setTimeout(() => window.close(), 2000);
    }
  </script>
</body>
</html>
